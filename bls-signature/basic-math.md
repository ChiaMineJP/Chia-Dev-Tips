# Basic Math

*   BLS Signature in Chia is based on bilinear pairing\
    &#x20;$$e: G_1 \times G_2 \rightarrow G_T$$

    Where $$G_1$$ and $$G_2$$ is a group of points on BLS12-381 curve with an prime order $$r$$ over a finite field with a 381 bit prime modulo $$q$$.

```python
r = 0x73EDA753299D7D483339D80809A1D80553BDA402FFFE5BFEFFFFFFFF00000001
q = 0x1A0111EA397FE69A4B1BA7B6434BACD764774B84F38512BF6730D2A0F6B0F6241EABFFFEB153FFFFB9FEFFFFFFFFAAAB
```

* The feature below is the core enabler for bls-signature:\
  $$e(\alpha P, \beta Q)=e(P,Q)^{ab}$$
  * $$P \in G_1, Q \in G_2$$
  * $$\alpha , \beta \in \Z_r (\Z\mod r)$$
  * $$e(P,Q)\in \Z_r$$
* Before proceeding ahead, I'll add some basic knowledge for better understanding

***

* Operation on elliptic curve
  * For distinct points $$P_1, P_2$$ on an elliptic curve $$E(F_q)$$, point add operation is defined as
    * Draw the line through $$P_1$$ and $$P_2$$
      * This line typically intersects the curve at exactly one other point $$P_3$$
      * Reflect $$P_3$$ across the x-axis (i.e. negate the y-coordinate)
      *   This leads to the equation:\
          $$P_1 + P_2 + P_3 = 0$$

          $$P_1 + P_2 = -P_3$$
  * If $$P_1$$ and $$P_2$$ is the same point, we do doubling a point like
    * Draw the tangent line at $$P_1$$
      * The line intersects the curve at a second point $$P'$$
      * Reflect $$P'$$ across the x-axis to get $$2P_1$$
  * There is an identity element $$O$$ (point at inifinity)
    * $$P + O = P$$ (additive identity)
  * Additive inverse looks like
    * $$P=(x,y)$$ then additive inverse $$-P = (x, -y)$$
      * $$P + (-P) = O$$
* In the context of a **cyclic group** $$G$$ of order $$r$$, a **generator** (often called a **base point** in elliptic curve groups) is an element $$g\in G$$ with the property that **every** element of $$G$$ can be expressed as some integer multiple of $$g$$.
* Concretely, if the group operation is written additively (as it is on elliptic curves), a generator $$P$$ satisfies:\
  $$G = \set{0\cdot P=O, 1\cdot P= P, 2P, 3P, \dots, (r-1)\cdot P}$$\
  $$O$$ is a point at inifinity (identity element in multiplication) where $$P + O = P$$
  * This means every point on $$G$$ is a multiply of an integer with a generator $$P$$
* In Chia's bls-signature
  * Private key: $$\text{sk} \in \Z_r$$\
    This means a Private key is generated by just giving a random integer with mod $$r$$ (group order of $$G_1, G_2, G_T$$)
  * Public key: $$\text{pk} = \text{sk} \cdot G_{1gen} = \underbrace{G_{1gen} + G_{1gen} + \dots + G_{1gen}}_{\text{sk}\space \text{times}}$$\
    $$G_{1gen}$$ is a generator (base point) in $$G_1$$
    * While $$sk \cdot G_{1gen}$$ can be efficiently computed by double-and-add algorithm, reverse engineering $$\text{sk}$$ by $$\text{pk}$$ and $$G_{1gen}$$ is infeasible because it falls onto discrete log problem.
  * Signature $$\sigma = \text{sk} \cdot H(m)$$
    * $$H(m)$$ is a message hashed into a point on $$G_2$$
    * $$H(m)$$ also can be expressed as $$H(m) = \mu\cdot G_{2gen}$$
* Verifying a signature with pk and message is done
  * &#x20;by checking whether $$e(G_{1gen}, \sigma)  =e(\text{pk}, H(m))$$
  * Using $$e(\alpha P, \beta Q)=e(P,Q)^{ab}$$,
    * $$e(G_{1gen},\space  \sigma )=e(G_{1gen},\space  \text{sk1}\cdot H(m_1))=e(G_{1gen},\space \text{sk1}\cdot \mu_1\cdot G_{2gen})=e(G_{1gen}, \space G_{2gen})^{\mu_1\cdot \text{sk1}}$$
    * $$e(\text{pk},\space H(m_2)) = e(\text{sk2}\cdot G_{1gen},\space \mu_2\cdot G_{2gen}) = e(G_{1gen},\space G_{2gen})^{\mu_2\cdot \text{sk2}}$$
    * So if $$\text{pk}$$ and $$\sigma$$ are derived by the same $$\text{sk}$$ and a message, then\
      $$e(G_{1gen}, \sigma)  =e(\text{pk}, H(m))$$



